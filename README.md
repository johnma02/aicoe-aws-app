`06/04/2023 - AWS AICoE Runoff Risk Prediction App`
## CodeBuild
When a push is made to the `main` branch, CodeBuild will run the `buildspec` files located in the root directory of the repository.

These `buildspec` files are used to build the Docker images for the front end, model and the `gdal`-based Lambda function.

## Getting Started: Local Development
The code repository is located <a href="https://github.com/johnma02/aicoe-aws-app"> here </a>.

To run code locally, fork and/or clone the repository.

I am available on GitHub to approve pull requests, should the CodeBuild pipeline
need to be run.

### Front End

The front end is built using Next.js. See <a href="https://github.com/johnma02/aicoe-aws-app/blob/main/aicoe-app/README.md">`aicoe-aws-app/README.md`</a> for instructions on running the front end on `localhost`.


While the backend is being developed, the front end will not be deployed on CodeDeploy, however, its Docker image is built by CodeBuild.

### Model

The model is hosted on AWS Lambda, however, it is packaged as a `Docker` container.
See <a href="https://github.com/johnma02/aicoe-aws-app/blob/main/model/Dockerfile">`model/Dockerfile`</a> for the container definition. 

There are many ways to test <a href="https://github.com/johnma02/aicoe-aws-app/blob/main/model/lambda_function.py">`model/lambda_function.py`</a> locally. I prefer to invoke the following command from the command line:
```bash
python -c "import lambda_function; lambda_function.lambda_handler({'day': '20080201', 'day_suffix': 0}, 'foo')"
```

I recommend using a Python virtual environment (`venv`) when testing the model locally. 

See <a href="https://github.com/johnma02/aicoe-aws-app/blob/main/model/requirements.txt">`model/requirements.txt`</a> for Python dependencies.

### `gdal`-based Lambda Image

`gdal-image` is an AWS Lambda image which processes the predictions generated by the model, and posts them onto Amazon S3.

See <a href="https://github.com/johnma02/aicoe-aws-app/blob/main/gdal-image/requirements.txt">`gdal-image/requirements.txt`</a> for Python dependencies.


### Navigating the AWS Console
The app uses the following AWS services:
- AWS CodeBuild (continuous integration / continuous deployment)
- AWS CodePipeline (not yet activated, for cost reasons)
- Amazon S3 (storing model predictions, generated projections)
- AWS ECR (storing Docker images)
- AWS Lambda (hosting the model)

There are IAM roles defined for each service with corresponding names and tags.

I am available on Slack or email (ma.jonathan02@gmail.com) to provide additional users access to the AWS console.

### Future Work
In the future, I hope to implement an additional Lambda function to extract
variables from our dataset and place them into MongoDB Atlas for our front end to utilize.